### 생성 날짜: 2024-03-25T21:26
### 주제: 모니터링과 로깅
---
### 본문:
## 모니터링 기술
블랙박스 모니터링: 애플리케이션 외부에 초점을 둡니다. ex. CPU, 메모리, 스토리지 등

화이트박스 모니터링: 애플리케이션 상태에 초점을 둡니다. ex. HTTP 요청 횟수, 레이턴시, 500 오류 수
- 현재 시스템의 상태가 왜 이런지 이해할 수 있다.

## 모니터링 패턴

- USE 패턴: 모든 리소스에 대해 사용률, 포화도, 오류율을 확인한다. -> 시스템의 리소스 제약과 오류율을 빠르게 파악할 수 있다.
- RED 패턴: 요청, 오류율, 소요 시간
- 네 가지 황금 신호: 레이턴스, 트래픽, 오류율, 포화도

결국에 요청이 얼마나 빠르게 성공적으로 처리되고 있는지를 빠르게 파악하기 위해 선정된 지표라고 생각한다.

## 메트릭 서버
HPA가 Horizontal Pod Autoscaler의 약자였구나,,,

메트릭 수집은 메트릭 API 표준 구현체가 존재하고, 이를 커스텀해서 사용할 수 있는 커스텀 구현체가 있다.
- https://kubernetes.io/docs/reference/instrumentation/metrics/
- https://github.com/kubernetes/kube-state-metrics

## 이후 모니터링 관련 (기술 위주이고, 기술은 변경되기 때문에 따라 작성하지 않음)

> 정보가 많으면 대시보드를 보는 사용자에게 혼란을 줄 수 있습니다. 대시보드를 설계할 때 문제 해결 시간과 결과에 중점을 두세요. p.73
> 너무 많은 노이즈 때문에 문제를 빠르게 발견하기 어렵습니다. p.73
> '저절로 문제가 해결되었습니다'라는 시나리오를 경험한 적이 있다면, 이는 대기 중인 엔지니어에게 알림할 필요가 없었음을 보여주는 좋은 표시입니다. p.79

대시보드를 설계할 때는 필요한 정보를 한 눈에 파악할 수 있는 것을 중심으로 구성해야하고, false alert이 오지는 않는지 지속적으로 확인해야한다.


> 로깅 도구는 쿠버네티스 데몬셋으로 실행되어야합니다.

왜 데몬셋으로 실행되어야만 하는 것인가 의문이 들어 찾아봤습니다.

DaemonSet은 쿠버네티스의 컨트롤러 중 하나로, 클러스터의 모든 노드(또는 지정된 노드)에 파드를 자동으로 배포하고 유지 관리하는 역할을 하기 때문에 일반적으로 효율적인 방법으로 분류된다. 효율적인 이유는 다음과 같다.
- 데몬셋은 노드 당 정확하게 1개의 팟으로 동작하기 때문에 노드 단위 로그 수집 보장한다.
- 데몬셋은 어차피 모니터링을 위해 모든 리소스를 보고 있기 때문에 로깅을 위한 추가적인 팟을 실행하지 않아도 된다.
	- 이런 이유로 보안 및 격리 관정에서도 유용하다.

> 직접 로깅 솔류션을 호스팅하는 것은 며칠까지는 문제가 없을 수도 있습니다. 하지만 환경이 거대해진다면 유지보수를 위한 시간이 늘어날 겁니다.

돈주고 맡길 수 있는 saas가 아주 와따봉이다.

> 플레이북 링크를 통해 문제 해결에 관한 정보를 줄 수 있습니다.

데이터독 알림 발생 시에 메시지 형식을 지정할 수 있고, 여기에 리소스 및 로깅 링크를 걸어두고 있다. 이렇게 하면 장애나 이슈가 발생했을 때 어렵지 않게 문제를 파악할 수 있다.

> 알림 피로를 조심하세요, 사람과 프로세스에 악영향을 끼칠 수 있습니다.

모두 알림 피로 조심하세욥~~


---
### 참고문헌
- 
---
### 연결문서
- 

