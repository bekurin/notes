### 생성 날짜: 2024-06-23T15:42
### 주제: 도메인 서비스
---
### 본문:

### 여러 애그리거트가 필요한 기능
📗: 이게 궁금했어!

> 생각해 볼 수 있는 방법은 주문 애그리거트가 필요한 데이터를 모두 가지도록 한 뒤 할인 금액 계산 책임을 주문 애그리거트에 할당하는 것이다. P.234

일반적인 구현하는 방식을 살펴보면 응용 서비스에서 애그리거트를 반환하는 다른 서비스 코드를 호출하여 금액 계산을 진행한다

위와 같이 구현하면 앞 전 장에서 저자가 말한 애그리거트를 반환하지 않는 응용 서비스를 벌써 위반한다.
📕: 하고 싶은 말은 애그리거트에 넣을 생각도 웬만하면 하지 않는다. 나도 안함

> 이렇게 한 애그리거트에 넣기 애매한 도메인 기능을 억지로 특정 애그리거트에 구현하면 안 된다. p.235

1. 애그리거트는 자신의 책임 범위를 넘어서는 기능을 구현하기 떄문에 코드가 길어진다.
2. 애그리거트가 외부에 대한 의존이 높아지면서 코드를 복잡하고, 유지보수하기 어렵게 만든다.

이를 부정할 수 있는 사람이 있을까..?? 궁금하다.
해결책은 도메인 서비스 구현!

### 도메인 서비스
> 할인 금액 규칙 계산처럼 한 애그리거트에 넣기 애매한 도메인 개념을 구현하려면 애그리거트에 억지로 넣기 보다는 도메인 서비스를 이용해서 도메인 개념을 명시적으로 드러내면 된다. p.237

할인 금액 계산 로직 DiscountCalculationService 클래스를 만들면 나중에 이해하기 더 쉽다.

애그리거트에서는 위에 구현한 도메인 서비스를 입력 받아 내부적으로 로직을 처리하면 된다. p.238
추가로 위와 같은 도메인 서비스를 애그리거트에 전달하는 책임은 응용 서비스가 지게 된다.

주의: Autowired를 사용해서 도메인에 도메인 서비스를 주입하지 말라. 데이터 자체를 관리하는 엔티티가 저장되지도 않을 데이터를 갖지 않아도 되고, 할인 계산 규칙이 응용 서비스마다 다르다고 하면 (ex. 정액 할인, 퍼센트 할인) 관리가 매우 어려워질 것 같다.

++ 
> 도메인 서비스는 도메인 로직을 수행하지 응용 로직을 수행하지 않는다. 트랜잭션 처리와 같은 로직은 응용 로직이므로 도메인 서비스가 아닌 응용 서비스에서 처리해야 한다. p.240

외부 시스템 연동과 도메인 서비스는 도메인 서비스로 구현되어야하는 것인지 확신이 없다...


---
### 참고문헌
- 
---
### 연결문서
- 

