## 37. 집계 쿼리에 페이징이 필요하다면 count를 사용해라
### 아무개의 이야기 
이번에는 예약 통계 정보를 구현하는 것이다. 현재 예약건, 이용 예정 예약건, 종료 예약건에 대해서 통계를 보여주는 것이다. 호기롭게 도전하여 기능 구현을 마쳤지만 운영 배포를 하니 페이징 처리가 제대로 되지 않는 것이다!

원인은 집계가 필요한 정보(현재 예약건, 이용 예정 예약건, 종료 예약건)에 대한 정보를  실행하는 쿼리에서 가져오는 것이 아닌 조회된 예약건을 service 레이어에서 집계를 한 것이 문제였다.

페이징은 일반적으로 page, size 정보를 넣게 되는데. 집계를 service 레이어에서 하면 예약건의 최댓값이 size의 값으로 고정되게 된다.

size가 50이라면 예약건은 최대 50개가 조회될테니!

따라서 이런 문제 발생을 해결하려면 집계가 필요한 정보에 대해서는 데이터베이스에서 실행하는 쿼리



집계가 필요한 쿼리에 페이징이 필요하다면 application 레벨에서 집계를 진행하면 안된다. Ex. 예약이 50건이 있다고 할 때 size가 20이면 50건의 예약을 모두 표현할 수 없기 때문에

페이징이 필요한 통계 정보가 있다고 하면 집계 관련 정보는 데이터베이스 조회 시점에서 가져올 수 있도록 한다.