## 오픈 소스
- 옵스디언 티스토리 블로그 업로드 기능 구현
	- https://github.com/bekurin/tistory-publisher
## 스터디
- 쿠버네티스 모범 사례:
	- 배경과 상황
		- 회사에서 쿠버네티스를 활용하여 어플리케이션을 배포하고 있는데 이를 잘 이해하지 못하고 있어. 이슈 및 장애 상황 발생 시에 대응하는데 어려움이 있어 공부를 시작했습니다.
	- 역할
		- 스터디 진행 방식과 진행 주도를 했습니다.
	- 스킬
		- kubernetes, helm
	- 액션
		- ingress, service, deployment 에 대한 이해를 늘렸다.
	- 결과
		- 법인 외부 차량 서비스 구현 시에 msa 환경에서 api를 호출할 수 있도록 ingress 수정
		- 같은 namespace에서는 서비스 호출 시에 namespace를 생략할 수 있다는 것을 공유
	- 회고
		- 쿠버네티스에 대해 이해할 수 있었지만 완벽하게 제어할 수 있게 된 것은 아니라고 생각했다.
		- 역시 공부할 것은 많다는 것을 또 한번 느끼면서 쿠버네티스를 대략적으로 나마 알 수 있어 좋다고 생각했다.
- 도메인 주도 설계:
	- 배경과 상황
		- 만 2년이 다 되어가는 상황에서 "내가 코드를 잘 작성하고 있나?"라는 의문이 들었다. 평소 DDD로 코드를 작성한다고 생각했는데. 이에 대해 공부를 해본적이 없고, 얕게 알고 있어 스터디를 진행했다.
	- 역할
		- 스터디 진행 방식과 진행 주도를 했습니다.
	- 스킬
		- DDD, jpa
	- 액션
		- Subslect에 대해 공유
		- Immutable에 대해 공유
		- 빈약한 도메인에 대한 개념 공유
		- 도메인 주도 설계 정식 도입 공유
	- 결과
		- 도메인 주도 설계를 도입한다고 했지만 지금까지 코드를 작성하면서 빈약한 도메인(링크)를 만들어내고 있다는 것을 깨달았다.
		- 스터디 내용을 정리하여 빈약한 도메인에 대한 설명과 도메인 주도 설계를 적용하면 코드 중복과 코드 복잡도를 낮출 수 있음을 팀에 공유하여 "도메인 서비스"를 도입하는 것에 대한 의견 전달하여 도메인 서비스를 팀에 도입했다.
	- 회고
		- 도메인 주도 설계를 한다고 생각했지만 트랜잭션 스크립트와 같은 코드를 작성하고 있었다...
		- JPA의 유용한 기능을 잘 사용하지 못하고 있음을 깨달았다.
- 실용주의 프로그래머:
	- 배경과 상황
		- 코드만 잘 작성한다고 좋은 개발자가 된다고 생각하지 않아. 좋은 개발자가 되기 위해서는 어떤 노력을 기울여야하는지 이해하고자 스터디를 진행했다.
	- 역할
		- 스터디 진행 방식 결정과 진행 주도를 했습니다.
	- 스킬
		- 실용주의 프로그래머
	- 액션
		- spring boot의 release note를 보면서 알게 된 내용이나 재밌는 개발 관련 내용을 접한 경우 팀 채널에 가볍게 전달했습니다.
		- 프로젝트를 진행하려면 서로 다른 많은 팀과의 협업이 필요하고, 팀 내에서도 많은 부분이 결정되게 되는데. 이를 잘 정리해두지 않으면 나중에 어떤 결정이 일어났는지 이해할 수 없어. 프로젝트마다 회의나 건의하고 싶은 내용을 문서화해뒀고, 프로젝트 회고에서 문서 정리가 많은 도움이 되었다는 피드백을 받았습니다.
	- 결과
		- 사람들이 코드에 붙은 여러분의 이름을 보고 그것이 튼튼하고 잘 작성되었으며 제대로 테스트되었을 뿐 아니라 훌륭히 문서화되었을 것이라고 기대하도록 만들자.
		- 개발자들에게만 문서를 공유하지 말고, 사업부서에게도 문서를 공유하여 모두가 잘 이해할 수 있는 문서를 만들 수 있도록 피드백을 받자.
	- 회고
		- 실용주의 프로그래머는 코드도 잘 작성하고, 문서화도 잘하며, 협업도 잘하는 사람인데 이를 모두 잘하기 위해서는 적절한 피드백 루프를 만들어야한다는 것을 알았다.
			- 코드를 잘 작성하기 위해서는 코드 리뷰도 중요한 역할을 하지만 테스트 코드를 작성하여 내가 원하는 상황에서 코드가 잘 동작하는지 확인하는 것이 중요하다
			- 문서화를 잘 하기 위해서는 문서를 읽고자 하는 대상이 누군인지, 문서를 작성하는 목적이 무엇인지 확실히 한 다음에 작성 해야한다.
			- 협업을 잘하기 위해서는 즉각적으로 의견을 교환할 수 있는 환경을 만들고, 눈에 보이는 결과를 만들어서 데모를 하는 것이 좋지만 서버 작업만 있는 경우 API 호출하는 것이라도 데모하는 것이 좋다.
## 프로젝트
- 쇼퍼 정산 프로젝트
	- 배경과 상황
		- 쇼퍼 서비스를 운영하면서 정산을 수기로 진행하고 있었는데. 수기로 진행하다보니 사람의 실수도 잦고 무엇보다도 정산과 검증에 많은 시간을 소요해서 정산 기능을 시스템화 하기로 결정
		- 금액만 계산해서 엑셀 파일로 만들어주면 결제 내역을 수기로 만들어주는 것이었는데 점점 규모가 커지더니 ERP까지 연동하여 버튼 한번만 누르면 정산이 끝나도록 구현했어.
	- 역할
	- 스킬
		- kotlin, spring boot 3
	- 액션
		- 매일매일 운행이 완료된 노선에 대해 단가가 저장될 수 있도록 구현.
		- 차량 고장 등의 이유로 대차가 이뤄지면 대차가 이뤄진 차량으로 정산이 되어야해서 대차 히스토리를 시스템에서 알 수 있도록 차량 계약 번호 자동 관리 시스템 구현.
		- 정규 운행이 아닌 기업의 요청으로 인해 부가적인 비용을 정산에 포함할 수 있도록 엑셀 입출력 기능 구현.
		- SAP 상에 차량이 등록될 수 있도록 배차/대차 시마다 차량 계약 번호 생성/갱신이 이뤄질 수 있도록 시스템화.
		- 정산 확정 처리를 하면 과금 데이터를 생성하여 ERP 매출 인식이 될 수 있도록 시스템화.
	- 결과
		- 정산 전주부터 사업부서에서 자료를 취합하고, 정산 정보를 생성하느라고 많은 시간을 사용했는데. 이 시간을 10시간에서 2시간으로 단축
	- 회고
		- 한번 확정 처리를 하면 정산 데이터를 snapshot을 찍어두고, 수정할 수 없도록 구현하는 것을 중요하게 생각했다.
- 법인 외부 차량 예약
	- 배경과 상황
		- 쏘카 소유의 차량이 아닌 법인 차량이 쏘카 앱 내에서 예약이 가능해야 했다.
		- 쏘카 존은 b2c 예약과 밀접하게 연관되어 있어 사용하지 못하는 수준이라서 가상존 마커 개념을 사용하여 예약이 가능하도록 구현했다.
		- pm 1명, be 2명, fe 2명
	- 역할
	- 스킬
		- kotlin, spring boot 2.7, buf, grpc
	- 액션
		- 가지러 가기 화면에서 가상존 마커가 비즈니스 프로필에 따로 선택적으로 보이도록 구현
		- 차량 리스트 화면에서 차종 기반으로 그룹핑 되지 않은 차량 리스트를 내려받을 수 있도록 구현
	- 결과
		- 쏘카 최초로 법인 외부 차량이 쏘카 앱 내에서 예약 가능한 프로세스를 구현함.
	- 회고
		- 쏘카의 정수라고 할 수 있는 예약과 가지러 가기 화면에 대해 많이 이해할 수 있는 시간을 가질 수 있어 좋았다.
		- 배치가 좋아 보이지만 암흑(?) 수정 같은 일이 가능하게 하여 변경에 매우 취약해지는 것 같다. (=적재적소에 잘 사용하자?)
- 카셰어링 레거시 예약 이관 대응
	- 배경과 상황
		- b2c 카셰어링팀에서 예약 API를 이관하는 과정에서 기업 관련 TC가 빠져 제대로 검증되지 않고, 운영 환경에 배포가 이뤄짐.
		- 이로 인해 다양한 문제를 맞닥뜨리게 되는데.
			- 결제 카드 순서 변경
			- 대표 카드 결제 기업 예약 불가
			- 후불 결제 기업의 개인 카드 결제 가능
			- 법인 예약이 일반 예약과 같이 취급되어 국세청 엑셀 다운로드에 포함 X
	- 역할
	- 스킬
		- 쏘카 로직의 구석구석까지 찾아다니면서 이해할 수 있게 되었다.
	- 액션
		- 기존 대표 카드 결제 기업의 경우 대표 카드가 맨 위에 나오도록 구현되어 있었지만 대표 카드 결제 기업은 대표 카드 이외 다른 모든 카드로 결제할 수 없기 때문에 대표 카드 1개만 내려가도록 수정
		- 비즈니스 플랜 차량과 해당 차량의 점유 정보를 기반으로 예약의 시작/종료 시간이 점유 시간에 포함되는지 계산하여 미비된 예약 건들이 국세청 엑셀 다운로드에 포함될 수 있도록 작업
		- QA TC에 B2B 관련 서비스가 포함될 수 있도록 모든 이슈에 대해 이슈 및 장애 보고서를 만들어서 본부 단위로 이슈 라이징
	- 결과
		- B2B 관련 서비스가 정기적으로 실행되는 QA TC에 포함되었다.
		- 대표 카드 결제가 설정된 기업의 경우 대표 카드가 제일 위에 선택되는 것이 아닌 대표 카드만 보이도록 의사소통 하여 개인 카드가 선택되는 행위가 일어나지 않도록 함.
	- 회고
		- 쏘카 앱 내에서 결제 카드를 내려주는 로직에 대해 이해할 수 있어 좋았다.
		- b2b일만 처리하다보니 TC의 중요도가 낮다고 생각했는데. 고객 접점이 많을 수록 필수적이라고 생각했다. 
			- QA팀에서 준비될 때까지 기다리는 것 보다 자동화된 테스트 케이스를 돌릴 수 있도록 깃헙 액션 같은거 만들어보는 것도 좋을 것 같다는 생각을 했다.
- 관리자 웹 사이트 인증 프로세스 개편
	- 배경과 상황
		- 레거시 API 서버 2개와 신규 API 서버의 인증 로직을 담고 있던 기존 로직을 하나의 인증 프로세스로 합쳤습니다.
	- 역할
	- 스킬
		- spring boot, jwt, jwk, cloud front, s3, 
	- 액션
		- sha256 알고리즘을 사용한 jwt를 사용했고, public key는 cloud front, s3를 사용하여 어디에서도 취득 가능하도록 구현했습니다.
	- 결과
		- 보안상 문제가 많던 기존 인증을 걷어낼 수 있었다.
		- 클라이언트 단에서 3개의 인증 토큰을 관리하면서 API 별로 토큰을 달리 주었어야 했는데 이제는 하나의 서버만 바라보고, 하나의 토큰만 잘 관리하면 되게 되었다.
		- 리프레쉬 컨셉을 도입할 수 있었다.
		- 범용적인 정보만 담고 있던 기존 토큰을 개선하여 B2B 팀에서 필요한 정보를 저장할 수 있도록 했다.
	- 회고
		- 인증/인가에 대해 이해를 할 수 있어 좋았고, public key를 cloud front, s3로 모두가 열람할 수 있도록 서버의 역할을 분리한 것이 인상적이었다.
		- HMAC 알고리즘을 사용하면 토큰을 디코딩 하려고 하는 서버마다 스크릿 키를 가지고 있어야하는데. 이를 분리할 수 있게 JWK 컨셉을 도입한 것이 좋았다.
- 법인 외부 차량 예약 분리
	- 배경과 상황
		- 이전 예약자와 이후 예약자를 보여주고, 예약 중간에 스마트키 권한을 다른 사람에게 넘기고 싶은 요구사항을 구현해야했다.
		- b2c에 제공되고 있던 기능을 완전히 동일하게 사용하고 있었는데. (=우리가 적용하면 다른 사람들도 볼 수 있는 상황) 이는 b2c 기존에서는 말도 안되는 요구사항이라서 근본적으로 예약이 저장되는 공간을 분리하는 것으로 결정했다.
			- 여기서 분리는 예약만 말한다.
	- 역할
		- 예약 CRUD API 구현
		- 예약, 차량 점유 데이터 모델링
		- 예약 시간 캐시 기능 구현
		- 예약 CS를 위한 백오피스 기능 구현
		- 예약 동기화 검증 시스템 구현
	- 스킬
		- kotlin, spring boot 3.3, grpc, buf
	- 액션
		- 예약 동시성 이슈를 해결하기 위해 갭락이라는 개념을 도입했다.
		- 거대한 쏘카의 수많은 서버가 예약 데이터를 어떻게 수정할지 모르기 때문에 예약 테이블의 cdc 이벤트 기반으로 신규 서버의 API를 테스트하여 엣지 케이스를 식별했다.
	- 결과
		- 법인 차량이 쏘카 앱 세상에서 예약할 수 있도록 하는 서비스를 완전히 분리해냈다.
			- 이로 인해 앞/뒤 예약자 정보 열람 등이 가능한 세상이 되었다.
	- 회고
		- 예약 테이블을 분리하는 프로젝트라서 처음에는 작업이 많지 않다고 느꼈다. 하지만 작업을 하다보니 지난 10여년 이어져온 쏘카의 코드를 이해해야 했고, 어떤 정책으로 인해 어떤 검증이 들어갔는지 등을 파악하는데 생각보다 많은 시간을 사용한 것 같다.
		- 예약 대사 시스템을 구축한 것은 굉장히 좋았다. 기존 예약 테이블의 CDC 이벤트를 기반으로 예약 대사 테이블을 만들어서 배치로 지속적으로 어떤 로직이 다른지 확인해보는 것이 좋았다.