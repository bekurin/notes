### 생성 날짜: 2024-04-22T20:36
### 주제: 상태와 스테이트풀 애플리케이션 관리
---
### 본문:
쿠버네티스를 사용하면 컨테이너의 수명이 일시적인 것과 더불어 상태를 저장하는 백업 스토리지가 컨테이너와 함께 삭제되는 등 일관되게 유지하는 것에 어려움이 있습니다.

## 볼륨과 볼륨 마운트

컨피그맵과 시크릿처럼 읽기 전용이 아닌 쓰기 가능하고 일관되게 유지가 되는 컨테이너 볼륨 시스템이 필요하다.

볼륨이 필요한 경우 외부 스토리지 시스템과 연계하여 사용 할 수 있다.
- 사이드카 패턴을 사용하여 외부 스토리지 시스템과 연계한다.
- 호스트 기반 로깅 도구를 사용하여 컨테이너 애플리케이션 로그를 볼륨에서 읽도록 한다.
p.270에 hostPath를 정의하는 방법이 구현되어 있다.

## 퍼시스턴트볼륨
퍼스시턴트볼륨은 볼륨을사용하는 파드의 라이프사이클과 독립된 볼륨의 범위를 정의하는 클레임 정책을 가지고 있습니다.

퍼시스턴트볼륨클레임은 파드가 사용할 스토리지에 대한 리소스 요구사항을 정의하는데 쿠버네티스는 클레임을 참조해서 클레임 요청과 일치하는 퍼시스턴트볼륨이 있다면 해당 볼륨을 특정 파드에 할당한다.

...스토리지 클래스, 컨테이너 스토리지 인터페이스와 플렉스 볼륨은 한번에 이해하지 못했다...

## 스테이트폴 애플리케이션
레플리카셋을 활용하는 것은 상태가 있는 스테이트폴 애플리케이션 관리에 해를 끼칠 수 있다.
- 레플리카셋의 파드는 스케줄링 때 수평 확장되고 무작위로 이름이 할당된다. <- 분산 저장을 할 때 어떤 파드가 어디까지 저장했는지 파악하기 어렵다.
- 레플리카셋의 파드는 임의의 방식으로 규모가 축소됩니다. <- min/max replicas가 정의되어 있는 경우 트래픽이 높을 때 늘어났다고, 트래픽이 안정적으로 변경되면 파드가 죽는다.
- 레플리카셋의 파드는 이름이나 IP 주소로 직접 호출되지 않고 Service를 통해 호출됩니다. <- 분산 저장을 사용할 때 어떤 레코드가 어디로 갈지 결정할 수 없다.
- 레플리카셋의 파드는 언제든 재시작하거나 다른 노드로 이동할 수 있습니다. <- 트랜잭션 처리 중에 재시작을 할 수 있다.

위와 같은 이유들 때문에 스테이트폴 셋이 생성되게 되었고, 스테이트풀셋의 특징은 p.277 아래부터 확인할 수 있습니다.

스테이트풀 셋은 백업과 장애 극복, 리더 등록, 신규 레플리카 등록 등 복잡한 작업이 주기적으로 실행된다. <- 장애가 발생할 때 원인 추적이 매우 어려울 수 있다.

위와 같은 어려움을 해결하기 위해 오퍼레이터를 사용할 수 있는데, 오퍼레이터는 사용자 정의 컨트롤러 로직을 사용하여 데이터 서비스와 스테이트 폴 셋을 효율적으로 관리할 수 있습니다.

---
### 참고문헌
- 
---
### 연결문서
- 

