### 생성 날짜: 2024-04-01T21:23
### 주제: 리소스 관리
---
### 본문:

## 쿠버네티스 스케줄러

p.142. 143

논리조건과 우선순위가 정의되어 있다 이를 이해하고 있다면 팟이 오토스케일링 되는 조건과 리소스 할당에 대해 잘 이해할 수 있을 것 같다.

> 노드가 같은 우선순위를 반환한다면 스케줄러는 selectHost() 함수를 사용하여 라운드 로빈 토너먼트 방식으로 노드를 선정합니다. p.143

같은 우선순위를 반환한다면 더 오랫동안 실행되어 있던 팟을 선정하는 것이 더 합리적으로 보이는데 오픈 소스 기여 각?

## 고급 스케줄링 기술

- 파드어피니티
- 안티어피니티
뭔지 모르겠다.

## 노드 셀렉터
특정 리소스를 특정 팟에 스케줄링 할 수 있다!

## 테인트와 톨러레이션
??

## 파드 리소스 관리

> 파드 리소스를 관리한다는 것은 전반적인 CPU와 메모리 사용률을 관리하여 쿠버네티스 클러스터의 활용도를 최적화하는 것을 의미합니다. p.147

오호, 의미는 알겠고, 사내에서는 왜 1core, 1.5GB가 표준인지 궁금하다.

## 리소스 요청
> 컨테이너가 8GB를 요청했는데 모든 노드에 7.5GB의 메모리만 존재한다면 파드는 스케줄링되지 못합니다. p.148

리소스가 부족하여 스케줄링 되지 못한 파드는 대기 상태가 되는 것이고, 대기 상태의 파드는 CPU, 메모리 리소스가 모두 0인가??

## 리소스 제한과 파드 서비스 품질

- 보장 Qos
- 폭발 Qos
- 최선의 노력 Qos

위에 3개가 무엇인지??

## PodDisruptionBudget

- 자발적 중단: 클러스터 유지보수, 클러스터 오케스케일러의 할당 해제, 파드템플릿 업데이트로 인해 발생한다.
- 비자발적 중단: 하드웨어 장애, 네트워크 분할, 커널 패닉, 리소스 부족 등으로 발생한다.

> 애플리케이션에 미치는 영향을 최소화하려면 PodDisruptionBudget을 설정하여 파드가 축출될 대 애플리케이션의 가동 시간을 보장하세요. P.151

트랙잭션 문제나 사용자 요청 처리 중에 네트워크가 끊어지는 broken pipeline이 발생하지 않도록 종료 대기 시간이 충분히 확보되어야하고, 이를 위해서는 spring boot에서 지원하는 graceful shutdown을 사용하면 될 것 같다. (쿠버네티스에서 설정하지 않아도)

- 최소 가용(minAvailable): 최소 이만큼은 실행되어 있어야지
- 최대 불가용(maxUnavailable): 최대 이만큼씩 재시작해

퍼센트(%)로 적응하면 반올림하여 적용한다.

## 네임스페이스를 사용한 리소스 관리
팀 단위로 네임스페이스를 부여하면 팀 단위로 리소스를 할당할 수 있다.

## 리소스 쿼터
- 계산 리소스
- 스토리지 리소스

CPU, 메모리 뿐 아니라 디스크의 리소스도 limit, request를 설정할 수 있다.

## LimitRange

파드에 기본 명세가 없는 경우 LimitRange를 정의하여 기본값으로 설정할 request, limit 값을 넣을 수 있다.

## 클러스터 확장
HPA로 스케일링 하자...

---
### 참고문헌
- 
---
### 연결문서
- 

