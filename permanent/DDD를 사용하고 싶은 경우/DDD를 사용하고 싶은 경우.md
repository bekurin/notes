### 생성 날짜: 2023-12-06T21:45
### 주제: DDD를 사용하고 싶은 경우
---
### 본문:
지금까지 개발을 하면서 DDD를 적용하고자 했고, 그 중에서도 Entity를 잘 설계하는 것을 목표로 했다. 이번 글에서는 Entity에 역할 수행을 위해 함수를 추가하는 경우를 소개하고, 몇가지 경우를 예로 들어 알아보고자 한다.

우선, DDD란 무엇인지 간략하게 알아보자. DDD는 도메인 주도 설계(Domain-Driven Design)의 약어로, 소프트웨어 개발에서 복잡한 도메인을 이해하고 그에 맞게 시스템을 구축하는 설계 방법론이다. 이는 Eric Evans가 2003년에 발표한 "도메인 주도 설계"라는 책에서 소개되었다. 더 자세한 내용은 관련 책을 보면서 학습하는 것을 추천한다.
- [도메인 주도 개발 시작하기.최범균.한빛미디어](https://www.yes24.com/Product/Goods/108431347)
- [도메인 주도 설계.에릭 에반스 저/ 이대엽 역.위키북스](https://www.yes24.com/Product/Goods/5312881)
- [도메인 주도 설계 철저 입문.나루세 마사노부 저/심효섭 역.위키북스](https://www.yes24.com/Product/Goods/93384475)

워낙 주변에서 DDD, DDD하기도 하고, 책을 찾아봐도 DDD가 짱이야라고 말하니 "그래서 DDD를 적용하면 무엇이 좋아지나요?" 라고 물어볼 수 있다.  
현재 주력으로 Spring Boot, Kotlin을 사용하여 웹 서버 개발을 하고 있는데. DDD를 사용하면서 다음과 같은 점들이 장점으로 느껴졌다.
- 테스트 하기 쉽다.
- 중복 코드를 줄일 수 있다.

### 테스트 하기 쉽다.
이것보다 큰 장점이 있을까? 한 예로 복잡한 서비스 레이어의 함수를 테스트 하다보면 test fixture를 생성과 함수 mocking을 위해 수십줄의 준비 코드를 준비해야한다. (준비를 위한 준비를 위한 준비...)

하지만 DDD에서 소개하는 Entity는 test fixture를 준비는 하겠지만 mocking을 진행하지는 않는다. 이로 인해 군더더기 없이 필요한 변수들만을 선언하여 테스트 코드를 작성할 수 있다.

### 중복 코드를 줄일 수 있다.
예를 들어 어떤 객체를 다른 객체로 변환해야하는 코드가 필요하다고 할 때. (피카츄 -> 라이츄) 상당 부분 공통 되는 것이 있다고 하면 서비스 레이어에 필요할 때 마다 아래와 같이 선언하게 될 것 이다.

```
val 피카츄1 = 피카츄()
val 라이츄1 = 라이츄(피카츄1.param1, 피카츄1.param2, 피카츄1.param3, name = "라이츄"...)
```

서비스 전반에 필요한 로직이라면 10 군데만 퍼져있어도 변경에 굉굉굉장장장히히히 취약하게 변한게 될 것이라고 확신한다.
### 연관된 객체로 변경해야하는 경우
예를 들어 정류장 정보(Station)가 데이터베이스에 저장되고, 몇가지 정보가 추가된 정류장 상세 정보(StationDetail)가 다른 테이블에 저장되어야한다면 

```
class Station {
	...
	fun toStationDetail(something1: String, something2: Int): StationDetail {
		return blablabla...
	}
}
```

### 객체의 값을 순환하는 경우
관계형 데이터베이스에서 1:N의 관계가 성립하는 경우 사용해볼 수 있다. 예를 들어 노선과 정류장이 존재하고, 주기적으로 노선의 마지막 정류장을 찾아야하는 경우가 있다면 아래와 같이 구현해볼 수 있다.

```
class Route {
	...
	fun getDestinationStation(): Station {
		return stations.last()
	}
}
```

위와 같이 구현하면 반복되는 부분을 모두 줄일 수 있다.

### 객체의 상태를 판단해야하는 경우
고속 버스 노선이 있고, 주말은 운행을 하지 않는다고 하면 아래와 같이 구현해볼 수 있다.
```
class Route {
	...
	fun isDriving(now: LocalDate): Boolean {
		return blabla...
	}

}
```

위 3가지 경우의 수를 보면 DDD를 적용해볼만 한 것들은 다대일, 일대다 관계에서 객체의 값을 순환하는 경우. 연관된 객체로 변환을 해야하는 경우. 객체의 값으로 어떤 상태를 판단해야하는 경우로 나눌 수 있다. 추가적으로 필요한 경우가 더 많겠지만 위 3가지는 DDD 적용을 적극 검토하는 것을 좋을 것 같다. 

---
### 참고문헌
- 
---
### 연결문서
- 

